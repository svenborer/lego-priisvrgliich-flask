<canvas id="canvas"></canvas>
<script>
    var config = {
        type: 'line',
        data: {
            labels: [
                {% for date in dates -%}
                    "{{ date }}",
                {%- endfor %}
            ],
            datasets: [
                {% for provider in prices %}
                    {
                    label: '{{ provider }}',
                    fill: false,
                    backgroundColor: '{{ prices[provider]["color"] }}',
                    borderColor: '{{ prices[provider]["color"] }}',
                    borderWidth: 1,
                    pointRadius: 1,
                    spanGaps: true,
                    data: [
                    {% for price in prices[provider]["prices"] -%}
                        {{ price }},
                    {%- endfor %}
                    ]},
                {% endfor %}
                ],
            },
        options: {
            legend: {
                display: false
            },
            responsive: true,
                title: {
                display: true,
                    text: 'Priis Chart'
            },
            tooltips: {
                mode: 'index',
                    intersect: false,
                },
            hover: {
                mode: 'nearest',
                    intersect: true
            },
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: false
                    }
                }],
            },
            annotation: {
                drawTime: 'afterDatasetsDraw',
                annotations: [
                    {% if bl_price %}
                    {
                    id: 'bl_price',
                    type: 'line',
                    mode: 'horizontal',
                    scaleID: 'y-axis-0',
                    value: {{ bl_price }},
                    borderColor: 'black',
                    borderWidth: 1,
                    label: {
                        backgroundColor: 'black',
                        content: 'Bricklink Price',
                        enabled: true
                    }}
                    {% endif %}
                    {% if list_price %}
                    , {
                    id: 'list_price',
                    type: 'line',
                    mode: 'horizontal',
                    scaleID: 'y-axis-0',
                    value: {{ list_price }},
                    borderColor: 'black',
                    borderWidth: 1,
                    label: {
                        backgroundColor: 'black',
                        content: 'List Price',
                        enabled: true
                    }}
                    {% endif %}
                ]
            }, 
            plugins: {
                zoom: {
                    // Container for pan options
                    pan: {
                        // Boolean to enable panning
                        enabled: true,

                        // Panning directions. Remove the appropriate direction to disable
                        // Eg. 'y' would only allow panning in the y direction
                        // A function that is called as the user is panning and returns the
                        // available directions can also be used:
                        //   mode: function({ chart }) {
                        //     return 'xy';
                        //   },
                        mode: 'x'
                    },

                    // Container for zoom options
                    zoom: {
                        // Boolean to enable zooming
                        enabled: true,
                        // Enable drag-to-zoom behavior
                        drag: true,
                        mode: 'x'
                    }
                }
            }
        }
    };

    window.onload = function () {
        var ctx = document.getElementById('canvas').getContext('2d');
        window.myLine = new Chart(ctx, config);
    };
</script>